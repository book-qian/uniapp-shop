"use strict";const e=require("../../common/vendor.js");if(!Array){(e.resolveComponent("uni-search-bar")+e.resolveComponent("uni-icons")+e.resolveComponent("uni-tag"))()}Math||((()=>"../../uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar.js")+(()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/uni-tag/components/uni-tag/uni-tag.js"))();const a={__name:"search",setup(a){const n=e.ref([]),o=e.ref(""),t=()=>{n.value=[],e.index.setStorageSync("kw","[]")},s=e.ref([]),u=async()=>{if(0===o.value.length)return void(s.value=[]);const{data:a}=await e.index.$http.get("/api/public/v1/goods/qsearch",{query:o.value}),{meta:t,message:u}=a;if(200!==t.status)return e.index.$showMessage();s.value=u,(()=>{const a=new Set(n.value);a.delete(o.value),a.add(o.value),n.value=Array.from(a),e.index.setStorageSync("kw",JSON.stringify(n.value))})()},r=e.ref(null),i=e=>{clearTimeout(r.value),r.value=setTimeout((()=>{o.value=e,u()}),500)},l=e.computed((()=>[...n.value].reverse()));return e.onLoad((()=>{n.value=JSON.parse(e.index.getStorageSync("kw")||"[]")})),(a,n)=>e.e({a:e.o(i),b:e.p({placeholder:"请输入搜索内容",cancelButton:"none",radius:100}),c:0!==o.value.length},0!==o.value.length?{d:e.f(s.value,((a,n,o)=>({a:e.t(a.goods_name),b:"046dbb10-1-"+o,c:e.o((n=>(({goods_id:a})=>{e.index.navigateTo({url:"/subpkg/goods_detail/goods_detail?goods_id="+a})})(a)),n),d:n}))),e:e.p({type:"arrowright",size:"16"})}:{f:e.o(t),g:e.p({type:"trash",size:"17"}),h:e.f(e.unref(l),((a,n,o)=>({a:e.o((n=>(a=>{e.index.navigateTo({url:"/subpkg/goods_list/goods_list?query="+a})})(a)),n),b:n,c:"046dbb10-3-"+o,d:e.p({inverted:!0,text:a})})))})}};wx.createPage(a);
//# sourceMappingURL=search.js.map
