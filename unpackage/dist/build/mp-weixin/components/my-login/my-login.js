"use strict";const e=require("../../common/vendor.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const t={__name:"my-login",setup(t){const a=e.useStore(),n=e.computed((()=>a.state.m_user.redirectInfo)),o=e=>{a.commit("m_user/updateUserinfo",e.detail.userInfo),s(e.detail)},s=async({encryptedData:t,iv:o,rawData:s,signature:i})=>{const{errMsg:r,code:c}=await e.index.login();if("login:ok"!==r)return e.index.$showMessage("登录失败");const u={code:c,encryptedData:t,iv:o,rawData:s,signature:i},{data:m}=await e.index.$http.post("/api/public/v1/users/wxlogin",u),{meta:d,message:p}=m;if(200==d.status)return e.index.$showMessage("登录失败");if(e.index.$showMessage("登录成功"),a.commit("m_user/updateToken","Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjIzLCJpYXQiOjE1NjQ3MzAwNzksImV4cCI6MTAwMTU2NDczMDA3OH0.YPt-XeLnjV-_1ITaXGY2FhxmCe4NvXuRnRB8OMCfnPo"),!n.value)return;const{openType:l="",from:f}=n.value;n.value&&"switchTab"===l&&e.index[l]({url:f,complete:()=>{a.commit("m_user/updateRedirectInfo",null)}})};return(t,a)=>({a:e.p({type:"contact-filled",size:"100",color:"#afafaf"}),b:e.o(o)})}};wx.createComponent(t);
//# sourceMappingURL=my-login.js.map
