"use strict";const e=require("../../common/vendor.js"),t=require("../../utils/api.js");if(require("../../utils/axios.js"),!Array){e.resolveComponent("uni-icons")()}Math;const a={__name:"my-login",setup(a){const s=e.useStore(),i=e.computed((()=>s.state.m_user.redirectInfo)),n=e=>{s.commit("m_user/updateUserinfo",e.detail.userInfo),o(e.detail)},o=async({encryptedData:a,iv:n,rawData:o,signature:r})=>{const{errMsg:u,code:c}=await e.index.login();if("login:ok"!==u)return e.index.$showMessage("登录失败");const m={code:c,encryptedData:a,iv:n,rawData:o,signature:r},{data:d}=await t.fetchPost("/api/public/v1/users/wxlogin",m),{meta:l,message:p}=d;if(200==l.status)return e.index.$showMessage("登录失败");if(e.index.$showMessage("登录成功"),s.commit("m_user/updateToken","Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjIzLCJpYXQiOjE1NjQ3MzAwNzksImV4cCI6MTAwMTU2NDczMDA3OH0.YPt-XeLnjV-_1ITaXGY2FhxmCe4NvXuRnRB8OMCfnPo"),!i.value)return;const{openType:f="",from:I}=i.value;i.value&&"switchTab"===f&&e.index[f]({url:I,complete:()=>{s.commit("m_user/updateRedirectInfo",null)}})};return(t,a)=>({a:e.p({type:"contact-filled",size:"100",color:"#afafaf"}),b:e.o(n)})}};wx.createComponent(a);
//# sourceMappingURL=my-login.js.map
