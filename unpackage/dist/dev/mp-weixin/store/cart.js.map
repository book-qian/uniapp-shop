{"version":3,"file":"cart.js","sources":["../../../../../store/cart.js"],"sourcesContent":["export default {\r\n\tnamespaced: true,\r\n\tstate: () => ({\r\n\t\t// 购物车数组 \r\n\t\t// 包含 goods_id goods_name goods_price goods_count goods_small_logo goods_state\r\n\t\tcart: JSON.parse(uni.getStorageSync('cart') || '[]')\r\n\t}),\r\n\tgetters: {\r\n\t\t// 购物车商品总数\r\n\t\ttotal(state) {\r\n\t\t\treturn state.cart.length\r\n\t\t},\r\n\t\t// 所有商品的总数量\r\n\t\tallCount(state) {\r\n\t\t\treturn state.cart.reduce((prev, goods) => prev + goods.goods_count, 0)\r\n\t\t},\r\n\t\t// 已选中商品的总数量\r\n\t\tcheckedCount(state) {\r\n\t\t\treturn state.cart.filter(t => t.goods_state).reduce((total, item) => total + item.goods_count, 0)\r\n\t\t},\r\n\t\t// 已选中商品的总价格\r\n\t\tcheckedGoodsAmount(state) {\r\n\t\t\treturn state.cart.filter(t => t.goods_state)\r\n\t\t\t\t.reduce((total, item) => total + (item.goods_count * item.goods_price), 0)\r\n\t\t\t\t.toFixed(2)\r\n\t\t}\r\n\t},\r\n\tmutations: {\r\n\t\t// 添加商品到购物车\r\n\t\taddToCart(state, goods) {\r\n\t\t\tconst findCart = state.cart.find(t => t.goods_id === goods.goods_id)\r\n\t\t\tif (!findCart) {\r\n\t\t\t\tstate.cart.push(goods)\r\n\t\t\t} else {\r\n\t\t\t\tfindCart.goods_count++\r\n\t\t\t}\r\n\t\t\tthis.commit('m_cart/saveToStorage')\r\n\t\t},\r\n\t\t// 本地持久化存储购物车信息\r\n\t\tsaveToStorage(state) {\r\n\t\t\tuni.setStorageSync('cart', JSON.stringify(state.cart))\r\n\t\t},\r\n\t\t// 更新购物车中商品的状态\r\n\t\tupdateGoodsState(state, goods) {\r\n\t\t\tconst findResult = state.cart.find(t => t.goods_id === goods.goods_id)\r\n\t\t\tif (findResult) {\r\n\t\t\t\tfindResult.goods_state = goods.goods_state\r\n\t\t\t\tthis.commit('m_cart/saveToStorage')\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 更新商品数量\r\n\t\tupdateGoodsCount(state, goods) {\r\n\t\t\tconst findResult = state.cart.find(t => t.goods_id === goods.goods_id)\r\n\t\t\tif (findResult) {\r\n\t\t\t\tfindResult.goods_count = goods.goods_count\r\n\t\t\t\tthis.commit('m_cart/saveToStorage')\r\n\t\t\t}\r\n\t\t},\r\n\t\tdeleteCartGoods(state, goods_id) {\r\n\t\t\tstate.cart = state.cart.filter(t => t.goods_id !== goods_id)\r\n\t\t\tthis.commit('m_cart/saveToStorage')\r\n\t\t},\r\n\t\t// 更新购物车所有商品的状态\r\n\t\tupdateAllGoodsState(state, checked) {\r\n\t\t\tstate.cart.forEach(t => t.goods_state = checked)\r\n\t\t\tthis.commit('m_cart/saveToStorage')\r\n\t\t}\r\n\t}\r\n}"],"names":["uni"],"mappings":";;AAAA,MAAe,aAAA;AAAA,EACd,YAAY;AAAA,EACZ,OAAO,OAAO;AAAA;AAAA;AAAA,IAGb,MAAM,KAAK,MAAMA,cAAAA,MAAI,eAAe,MAAM,KAAK,IAAI;AAAA,EACrD;AAAA,EACC,SAAS;AAAA;AAAA,IAER,MAAM,OAAO;AACZ,aAAO,MAAM,KAAK;AAAA,IAClB;AAAA;AAAA,IAED,SAAS,OAAO;AACf,aAAO,MAAM,KAAK,OAAO,CAAC,MAAM,UAAU,OAAO,MAAM,aAAa,CAAC;AAAA,IACrE;AAAA;AAAA,IAED,aAAa,OAAO;AACnB,aAAO,MAAM,KAAK,OAAO,OAAK,EAAE,WAAW,EAAE,OAAO,CAAC,OAAO,SAAS,QAAQ,KAAK,aAAa,CAAC;AAAA,IAChG;AAAA;AAAA,IAED,mBAAmB,OAAO;AACzB,aAAO,MAAM,KAAK,OAAO,OAAK,EAAE,WAAW,EACzC,OAAO,CAAC,OAAO,SAAS,QAAS,KAAK,cAAc,KAAK,aAAc,CAAC,EACxE,QAAQ,CAAC;AAAA,IACX;AAAA,EACD;AAAA,EACD,WAAW;AAAA;AAAA,IAEV,UAAU,OAAO,OAAO;AACvB,YAAM,WAAW,MAAM,KAAK,KAAK,OAAK,EAAE,aAAa,MAAM,QAAQ;AACnE,UAAI,CAAC,UAAU;AACd,cAAM,KAAK,KAAK,KAAK;AAAA,MACzB,OAAU;AACN,iBAAS;AAAA,MACT;AACD,WAAK,OAAO,sBAAsB;AAAA,IAClC;AAAA;AAAA,IAED,cAAc,OAAO;AACpBA,oBAAG,MAAC,eAAe,QAAQ,KAAK,UAAU,MAAM,IAAI,CAAC;AAAA,IACrD;AAAA;AAAA,IAED,iBAAiB,OAAO,OAAO;AAC9B,YAAM,aAAa,MAAM,KAAK,KAAK,OAAK,EAAE,aAAa,MAAM,QAAQ;AACrE,UAAI,YAAY;AACf,mBAAW,cAAc,MAAM;AAC/B,aAAK,OAAO,sBAAsB;AAAA,MAClC;AAAA,IACD;AAAA;AAAA,IAED,iBAAiB,OAAO,OAAO;AAC9B,YAAM,aAAa,MAAM,KAAK,KAAK,OAAK,EAAE,aAAa,MAAM,QAAQ;AACrE,UAAI,YAAY;AACf,mBAAW,cAAc,MAAM;AAC/B,aAAK,OAAO,sBAAsB;AAAA,MAClC;AAAA,IACD;AAAA,IACD,gBAAgB,OAAO,UAAU;AAChC,YAAM,OAAO,MAAM,KAAK,OAAO,OAAK,EAAE,aAAa,QAAQ;AAC3D,WAAK,OAAO,sBAAsB;AAAA,IAClC;AAAA;AAAA,IAED,oBAAoB,OAAO,SAAS;AACnC,YAAM,KAAK,QAAQ,OAAK,EAAE,cAAc,OAAO;AAC/C,WAAK,OAAO,sBAAsB;AAAA,IAClC;AAAA,EACD;AACF;;"}