{"version":3,"file":"goods_list.js","sources":["../../../../../../subpkg/goods_list/goods_list.vue","../../../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c3VicGtnL2dvb2RzX2xpc3QvZ29vZHNfbGlzdC52dWU"],"sourcesContent":["<template>\n\t<view class=\"goods-list\">\n\t\t<view v-for=\"(goods, i) in goodsList\" :key=\"i\" @click=\"gotoGoodsDetail(goods)\"><my-goods :goods=\"goods\"></my-goods></view>\n\t</view>\n</template>\n\n<script setup>\nimport { ref, reactive } from 'vue';\nimport { onLoad, onReachBottom, onPullDownRefresh } from '@dcloudio/uni-app';\n\nconst queryObj = reactive({\n\tquery: '',\n\tcid: '',\n\tpagenum: 1,\n\tpagesize: 10\n});\nconst isload = ref(false); // 节流阀\nconst total = ref(0);\nconst goodsList = ref([]);\nconst getGoodsList = async cb => {\n\tisload.value = true;\n\tconst { data: res } = await uni.$http.get('/api/public/v1/goods/search', queryObj);\n\tisload.value = false;\n\n\t// 下拉刷新请求数据之后 关闭下拉效果\n\tcb && cb();\n\n\tconst { meta, message } = res;\n\tif (meta.status !== 200) return uni.$showMessage();\n\ttotal.value = message.total;\n\tgoodsList.value = [...goodsList.value, ...message.goods];\n};\n\nconst gotoGoodsDetail = ({ goods_id }) => {\n\tuni.navigateTo({\n\t\turl: '/subpkg/goods_detail/goods_detail?goods_id=' + goods_id\n\t});\n};\n\n// 触底事件/上拉加载\nonReachBottom(() => {\n\t// 判断数据加载完毕\n\tif (queryObj.pagenum * queryObj.pagesize >= total.value) return uni.$showMessage('数据加载完毕');\n\tif (isload.value) retuen;\n\tqueryObj.pagenum++;\n\tgetGoodsList();\n});\n\n//下拉刷新\nonPullDownRefresh(() => {\n\tqueryObj.pagenum = 1;\n\ttotal.value = 0;\n\tgoodsList.value = [];\n\n\t// 重新获取数据\n\tgetGoodsList(() => uni.stopPullDownRefresh());\n});\n\nonLoad(({ query = '', cid = '' }) => {\n\tqueryObj.query = query;\n\tqueryObj.cid = cid;\n\tgetGoodsList();\n});\n</script>\n\n<style lang=\"scss\"></style>\n","import MiniProgramPage from '/Users/yangyongqian/code/uni-shop/subpkg/goods_list/goods_list.vue'\nwx.createPage(MiniProgramPage)"],"names":["reactive","ref","uni","onReachBottom","onPullDownRefresh","onLoad"],"mappings":";;;;;;;;;;;;;AAUA,UAAM,WAAWA,cAAAA,SAAS;AAAA,MACzB,OAAO;AAAA,MACP,KAAK;AAAA,MACL,SAAS;AAAA,MACT,UAAU;AAAA,IACX,CAAC;AACD,UAAM,SAASC,cAAAA,IAAI,KAAK;AACxB,UAAM,QAAQA,cAAAA,IAAI,CAAC;AACnB,UAAM,YAAYA,cAAAA,IAAI,CAAA,CAAE;AACxB,UAAM,eAAe,OAAM,OAAM;AAChC,aAAO,QAAQ;AACf,YAAM,EAAE,MAAM,IAAG,IAAK,MAAMC,cAAAA,MAAI,MAAM,IAAI,+BAA+B,QAAQ;AACjF,aAAO,QAAQ;AAGf,YAAM,GAAE;AAER,YAAM,EAAE,MAAM,QAAS,IAAG;AAC1B,UAAI,KAAK,WAAW;AAAK,eAAOA,cAAG,MAAC,aAAY;AAChD,YAAM,QAAQ,QAAQ;AACtB,gBAAU,QAAQ,CAAC,GAAG,UAAU,OAAO,GAAG,QAAQ,KAAK;AAAA,IACxD;AAEA,UAAM,kBAAkB,CAAC,EAAE,eAAe;AACzCA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,gDAAgD;AAAA,MACvD,CAAE;AAAA,IACF;AAGAC,kBAAAA,cAAc,MAAM;AAEnB,UAAI,SAAS,UAAU,SAAS,YAAY,MAAM;AAAO,eAAOD,cAAG,MAAC,aAAa,QAAQ;AACzF,UAAI,OAAO;AAAO;AAClB,eAAS;AACT;IACD,CAAC;AAGDE,kBAAAA,kBAAkB,MAAM;AACvB,eAAS,UAAU;AACnB,YAAM,QAAQ;AACd,gBAAU,QAAQ;AAGlB,mBAAa,MAAMF,cAAAA,MAAI,oBAAmB,CAAE;AAAA,IAC7C,CAAC;AAEDG,kBAAM,OAAC,CAAC,EAAE,QAAQ,IAAI,MAAM,GAAE,MAAO;AACpC,eAAS,QAAQ;AACjB,eAAS,MAAM;AACf;IACD,CAAC;;;;;;;;;;;;;;;;;;AC7DD,GAAG,WAAW,eAAe;"}